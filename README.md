# Бот для курса BotOn
Привет, я Рома, тут ты можешь исходный код бота для группы [Профсоюзная организация ЮУрГУ](https://vk.com/profkom_susu "Профсоюзная организация ЮУрГУ"), написанный в рамках курса BotOn.

------------

#### User

Каждый пользователь представляет собой объект [User](https://github.com/SumJest/boton/blob/master/utils/usermanager.py#L5 "User") и сохранён в файле в директории **/users/** в виде json объекта. Он имеет следующие параметры:
```python
    user_id: int
    action_state: int
    is_blocked: bool
    groups: typing.List[str]
    subs: typing.List[str]
```
Параметр `groups`  хранит в себе роли, которым принадлежит пользователь. К примеру *admin*, *expert*. <br />
Параметр `action_state` хранит в себе текущее состояние пользователя. Все состояния описаны в файле [usermanager.py](https://github.com/SumJest/boton/blob/master/utils/usermanager.py "usermanager.py")


------------

#### Клавиатуры

Каждая клавиатура хранится в директории **/keyboards/** как json объект. При запуске бота или вызове функции `reload()` из [KeyboardManager](https://github.com/SumJest/boton/blob/master/utils/keyboardmanager.py "KeyboardManager") клавиатуры считываются сохраняются в том же классе в параметре `keyboards`. 

Каждая клавиша может имееть следующие параметры в полезной нагрузке, в зависимости от которого кнопка будет выполнять функцию:
- `btn_id` - id функции, которую должна выполнить  кнопка.
  - `0` - отмена/вернутся. Очищает состояние пользователя и отправляет основную клавитуру
  - `1` - Отправить подписки на хэштеги пользователю
  - `2` - Перевести пользователя в режим ввода хэштега 
  - `3` - Перевести пользователя в режим удаления хэштега
  - `4` - Перевести пользователя в режим ввода вопроса
- `kb_id` - id клавиатуры, которой принадлежит кнопка
- `txt_id` - id текста из директории **/texts/{keyboard}/** который бот должен отправить тексту по нажатию на кнопку
- `open_id` - id клавиатуры, которая должна открыться у пользователя

##### Главная клавиатура

[![main keyboard](https://i.imgur.com/19VrbCZ.png "main keyboard")](https://imgur.com/a/VHGVpkF "main keyboard")

- Зеленые кнопки открывают подменю
- Синие кнопки выводят текст
- Серые кнопки функциональные
- Красные кнопки возврат/удаление

##### Клавиатура Подписки
[![sub keyboard](https://i.imgur.com/Iqcm1iS.png "sub keyboard")](https://imgur.com/a/VHGVpkF "sub keyboard") 

Клавиатура для управления подписками на хэштэги.

------------


#### Подписки

У пользователя есть возможность подписаться на интересующие его хэштеги, при этом ему бот будет пересылать все посты, содержащие в себе интересущие его хэштэги. 
Подписки хранятся в параметрах пользователя.

------------


#### Обратная связь с администраторами

Для обратной связи используется кнопка **Задать вопрос** в главной клавиатуре. По нажатию на которую пользователю предлагается ввести свой вопрос. После этого диалог с пользователем помечается как важный.
 

------------


*Бот написан с помощью библиотеки [vkwave](https://github.com/fscdev/vkwave "vkwave").*